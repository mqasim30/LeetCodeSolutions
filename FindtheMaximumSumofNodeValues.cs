using System.Numerics;

namespace LeetCode.FindtheMaximumSumofNodeValues
{
        public class Solution
        {
            public long MaximumValueSum(int[] nums, int k, int[][] edges)
            {
                long result = 0;
                
                for (int i = 0; i < nums.Length; i++)
                {
                    result += nums[i];
                }

                int[] deltaNums = new int[nums.Length];
                for (int i = 0; i < nums.Length; i++)
                {
                    deltaNums[i] = (nums[i] ^ k) - nums[i];
                }

                Array.Sort(deltaNums, (x, y) => y.CompareTo(x));

                for (int i = 0; i < deltaNums.Length; i += 2)
                {
                    if (i + 1 > deltaNums.Length - 1)
                    {
                        break;
                    }
                    
                    if (deltaNums[i] + deltaNums[i + 1] > 0)
                    {
                        result += deltaNums[i] + deltaNums[i + 1];
                    }
                }
                
                return result;
            }
        }
    // public class Program
    // {
    //     public static void Main(string[] args)
    //     {
    //         Solution solution = new Solution();
    //         int[] nums = [648175640,461053352,68034989,948687453,137896977,726003180,418005303,114316190,742957514,642265435,155265859,207926903,121719719,52594433,36907847,215326057,963395921,855612071,675243958,231873874,633827962,337247423,597224909,911148396,566917786,303660469,819298119,578280205,673741883,517638933,654497519,617918220,408331793,829776109,528809955,30561249,201954666,519403498,353362622,724761559,205348417,785458273,673734043,863380188,207879466,901072736,510529475,653110011,577599309,572385045,767593172,545150514,81575736,215306160,49053448,798836820,281895858,724045128,429925946,418277825,51553283,618007377,664643406,943628397,530757994,18274069,876953367,358385039,361364433,235326580,975722931,736470489,278244865,427184171,566406348,888408616,367087686,612212886,264720461,604362451,326870971,673175743,192269509,598806344,222785479,318077216,288794879,905804773,865096113,579103458,739298343,419431173,849104420,618233136,7861295,231566770,533331246,35129842,369584259,548350663,64625259,3845037,865159306,27661926,931177700,989455165,93759179,868076650,241533482,372565280,546154621,805757108,977643233,908256630,124601946,165732765,513941554,778416569,177929710,225129752,26018431,81814919,499485683,334778408,338994909,423913969,882431823,436911799,463155693,254765323,600707272,254226921,676755947,122516147,658451770,228335068,589898550,275613696,797104946,97657609,412700500,418159600,438523548,505363266,745866293,564578451,277906062,447443407,797703639,760982256,333407721,758261074,812063020,717198423,788951680,833219193,901124037,538893143,598882459,921478628,155565589,48450276,49572683,342431927,513342853,958467043,124804788,536570935,466811979,317930272,393379683,947146615,124550248,837303008,227857730,596887836,247734310,106146033,414594335,935452324,355791005,678618476,16066807,902456857,650884791,178719664,146076221,709177921,538169765,795163906,509385091,994931669,760170296,901998088,563777607,672813311,842412944,777987362,133661415,434127798,373943637,713977056,721256558,733937613,425378283,151570057,195017856,79926010,405677414,591749140,912305303,201655928];
    //         int k = 152;
    //         int[][] edges = [[2,33],[4,86],[6,19],[192,11],[78,12],[13,27],[15,97],[16,142],[21,67],[94,22],[23,61],[25,161],[111,31],[37,35],[37,160],[80,38],[78,41],[43,42],[83,44],[27,45],[202,48],[53,10],[29,55],[56,27],[59,185],[147,60],[63,3],[186,3],[68,169],[73,145],[193,74],[93,78],[79,164],[163,82],[84,30],[0,30],[95,85],[176,87],[125,91],[70,94],[67,70],[67,173],[88,97],[103,88],[98,9],[50,99],[20,50],[10,100],[10,103],[103,75],[108,144],[148,109],[54,111],[102,112],[102,1],[75,1],[113,143],[115,39],[123,119],[188,120],[162,121],[122,58],[123,39],[7,39],[7,125],[124,126],[124,106],[127,90],[128,185],[130,160],[186,131],[137,139],[140,189],[141,32],[142,150],[101,144],[69,147],[105,148],[105,138],[138,81],[0,150],[27,0],[27,145],[179,145],[107,151],[152,134],[93,134],[153,32],[80,32],[154,80],[154,196],[155,189],[193,156],[157,172],[158,46],[107,46],[107,69],[69,194],[161,170],[163,92],[83,92],[208,164],[166,65],[61,168],[172,171],[110,172],[24,175],[167,180],[167,43],[43,76],[58,76],[198,181],[182,75],[75,211],[58,183],[58,29],[29,202],[116,185],[159,116],[186,86],[86,83],[187,117],[72,117],[188,114],[197,114],[40,191],[209,40],[132,196],[132,162],[179,162],[179,110],[110,57],[57,192],[192,129],[173,129],[173,77],[77,36],[198,136],[90,136],[178,90],[178,199],[206,199],[197,200],[197,33],[165,33],[165,9],[9,174],[174,177],[201,89],[89,54],[5,54],[202,101],[160,203],[160,81],[81,5],[66,5],[139,66],[193,139],[204,36],[18,36],[18,61],[205,159],[206,71],[26,207],[96,26],[96,101],[101,194],[194,118],[49,118],[72,49],[190,72],[208,24],[28,24],[28,176],[176,193],[143,193],[7,143],[95,7],[95,17],[17,169],[169,135],[106,135],[83,106],[83,61],[209,61],[209,159],[159,62],[71,62],[71,195],[146,195],[177,146],[47,177],[47,19],[34,19],[34,184],[93,184],[93,149],[149,14],[14,51],[210,104],[104,52],[52,170],[8,170],[65,8],[65,189],[64,189],[64,20],[51,20],[51,190],[190,133],[211,133]];
    //         System.Console.WriteLine(solution.MaximumValueSum(nums, k, edges));
    //     }
    // }
}